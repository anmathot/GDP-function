---
title: "GDP function"      
author: "A. Mathot"        
output: 
  flexdashboard::flex_dashboard:
    theme: spacelab
runtime: shiny               
--- 

  
```{r packages, include=FALSE}
require(ggplot2)
require(plotly)
require(shiny)
require(kableExtra)
require(knitr)
require(readxl)
theme_set(theme_bw())
library(dplyr)
library(tidyr)
library(pandocfilters)
library(tibble)
```

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  tidy    = "styler",
  comment = NA, 
  echo = FALSE
)
```


```{r}
data <- read.csv(file = "Data.csv", header = TRUE, sep = "\t",dec =",",row.names =1)
```

# Structure of Data:
## {.sidebar} 

<br>

---

```{r}
renderUI({
  sliderInput("range",   
    label = "Rows to display",  
    value = 25,
    min = 1, max = nrow(data),
    step = 1)
}
)

```
---

##

###

<br>

```{r}
dataf <- data %>%
  add_column(Countries = c(row.names(data)),
             .before = "X1960") 
renderTable({
  rg <- input$range
  rmarkdown::paged_table(dataf[1:rg, ])
    })
```




# Static graph:
## {.sidebar}

<br>

---

```{r}
Nbr = c(1:267)
Pays = c(row.names(data))
Data <- data.frame(x = Nbr, y = Pays)
Data |>
  knitr::kable(
    caption = "Number to choose for the value of a for the chosen Country", col.names = c("a", "Country"))

```

```{r}
rmarkdown::paged_table(Data)
```

---

##

###



```{r}
y <- data[18,]
x <- as.numeric(data[267,1:62])
Y <- as.numeric(y[1, 1:62])
Data = data.frame(x, Y)
Country1 <- ggplot(Data, aes(x = x, y = Y)) + 
  geom_line(color = "red")+
  geom_point(color = "black", shape = 8)+
  labs(title = "Gdp of Belgium (18) over years", x = "Years", y = "Gdp")
ggplotly(Country1)
```

# Display the chosen country:
## {.sidebar}

<br>

---
```{r}
data <- read.csv(file = "Data.csv", header = TRUE, sep = "\t",dec =",",row.names =1)

Nombre = c(1:267)
Pays = c(row.names(data))
Data1 <- data.frame(x = Nombre, y = Pays)
```

```{r}
selectInput(
    inputId = "pays",               
    label = "Choose a country",
    choice = row.names(data),
    selected = "Belgique"  
  )
```

---

##

###

```{r}
renderPlot({
    pAys <- input$pays
    Frame <- data.frame(x = c(as.numeric(data[267,1:62])), y = c(as.numeric(data[pAys, 1:62])))
    ggplot(data = Frame, aes(x = x, y = y)) +
      geom_point(color = "black", shape = 8)+
      geom_line(color = "red")+
      labs(title = paste('Evolution of the gdp of',pAys, '.'), y = "GDP",x = "Years")
})
```


